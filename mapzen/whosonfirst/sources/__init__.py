# https://pythonhosted.org/setuptools/setuptools.html#namespace-packages
__import__('pkg_resources').declare_namespace(__name__)

# https://github.com/whosonfirst/whosonfirst-sources/blob/master/data/sources-spec-latest.json
# (20160518)

__SPEC__ = {"404734209": {"name": "minitenders", "license": "", "url": "http://www.thebolditalic.com/articles/1101-mini-tenders", "prefix": "mt", "key": "id", "fullname": "Mini Tenders", "id": 404734209, "description": ""}, "404734211": {"name": "nullisland", "license": "", "url": "http://www.nullisland.com/", "prefix": "ni", "key": "", "fullname": "Null Island", "id": 404734211, "description": ""}, "404734213": {"name": "missing", "license": "", "url": "", "prefix": "xx", "key": "", "fullname": "Missing", "id": 404734213, "description": "Missing - as in a placeholder for WOF records without a geometry"}, "404734215": {"name": "whosonfirst", "license": "CC0", "url": "http://whosonfirst.mapzen.com/", "prefix": "wof", "key": "id", "fullname": "Who's On First", "id": 404734215, "description": ""}, "840464273": {"name": "nytimes", "license": "", "url": "http://www.nytimes.com/", "prefix": "nyt", "key": "id", "fullname": "The New York Times", "id": 840464273}, "840464229": {"name": "fips", "license": "https://www.usa.gov/government-works", "url": "http://www.nist.gov/itl/fips.cfm", "prefix": "fips", "key": "id", "fullname": "Federal Information Processing Standards", "id": 840464229}, "840464281": {"name": "dbpedia", "license": "http://en.wikipedia.org/wiki/Wikipedia:Text_of_Creative_Commons_Attribution-ShareAlike_3.0_Unported_License", "url": "http://dbpedia.org/", "prefix": "dbp", "key": "id", "fullname": "Dbpedia", "id": 840464281}, "840464293": {"name": "faa", "license": "https://www.usa.gov/government-works", "url": "http://www.faa.gov/", "prefix": "faa", "key": "code", "fullname": "Federal Aviation Administration", "id": 840464293}, "840464287": {"name": "freebase", "license": "http://creativecommons.org/licenses/by/2.5/", "url": "https://en.wikipedia.org/wiki/Freebase", "prefix": "fb", "key": "id", "fullname": "Freebase", "id": 840464287}, "420573473": {"name": "unlocode", "license": "http://www.unece.org/cefact/locode/locode_since1981.html", "url": "http://www.unece.org/cefact/locode/welcome.html", "prefix": "unlc", "key": "id", "fullname": "UN/LOCODE (United Nations Code for Trade and Transport Locations)", "id": 420573473}, "554906275": {"name": "statcan", "license": "http://www.statcan.gc.ca/eng/reference/licence-eng", "url": "http://statcan.gc.ca/", "prefix": "statcan", "key": "", "fullname": "Statistics Canada", "id": 554906275, "description": ""}, "772974267": {"name": "sfgov", "license": "https://data.sfgov.org/terms-of-use", "url": "https://data.sfgov.org/", "prefix": "sfgov", "key": "", "fullname": "City of San Francisco", "id": 772974267, "description": ""}, "840464241": {"name": "iata", "license": "", "url": "http://www.iata.org/", "prefix": "iata", "key": "code", "fullname": "International Air Transport Association", "id": 840464241}, "840464301": {"name": "loc", "license": "https://www.usa.gov/government-works", "url": "http://www.loc.gov", "prefix": "loc", "key": "id", "fullname": "Library of Congress", "id": 840464301}, "840464303": {"name": "mapzenborders", "license": "CC0", "url": "https://mapzen.com/data/borders/", "prefix": "mzb", "key": "id", "fullname": "Mapzen Borders", "id": 840464303, "description": ""}, "772975927": {"name": "chgov", "license": "http://data.geo.admin.ch/ch.swisstopo-vd.ortschaftenverzeichnis_plz/", "url": "http://data.geo.admin.ch", "prefix": "chgov", "key": "", "fullname": "Swiss Confederation", "id": 772975927, "description": ""}, "772974303": {"name": "sfac", "license": "", "url": "http://www.sfartscommission.org/", "prefix": "sfac", "key": "id", "fullname": "San Francisco Arts Commission", "id": 772974303, "description": ""}, "823312445": {"name": "atgov", "license": "http://creativecommons.org/licenses/by/3.0/at/", "url": "https://www.data.gv.at", "prefix": "atgov", "key": "", "fullname": "data.gv.at", "id": 823312445, "description": ""}, "554867137": {"name": "uszcta", "license": "", "url": "http://www.census.gov/geo/reference/zctas.html", "prefix": "uszcta", "key": "id", "fullname": "US ZIP Code Tabulation Area", "id": 554867137, "description": ""}, "656342179": {"name": "nycgov", "license": "http://www.nyc.gov/html/misc/html/tou.html", "url": "https://data.cityofnewyork.us/", "prefix": "nycgov", "key": "id", "fullname": "NYC OpenData", "id": 656342179}, "840464249": {"name": "icao", "license": "", "url": "http://www.icao.int/", "prefix": "icao", "key": "code", "fullname": "International Civil Aviation Organization", "id": 840464249}, "840464261": {"name": "tgn", "license": "http://opendatacommons.org/licenses/by/1-0/", "url": "https://www.getty.edu/research/tools/vocabularies/tgn/index.html", "prefix": "tgn", "key": "id", "fullname": "Getty Thesaurus of Geographic Names", "id": 840464261}, "404734173": {"name": "edtf", "license": "", "url": "http://loc.gov/standards/datetime/", "prefix": "edtf", "key": "", "fullname": "Extended Date/Time Format", "id": 404734173}, "404734175": {"name": "geonames", "license": "http://www.geonames.org/about.html", "url": "http://www.geonames.org/", "prefix": "gn", "key": "id", "fullname": "GeoNames", "id": 404734175}, "404734177": {"name": "geoplanet", "license": "http://developer.yahoo.com/geo/geoplanet/data/", "url": "http://developer.yahoo.com/geo/geoplanet/", "prefix": "gp", "key": "id", "fullname": "Yahoo! GeoPlanet", "id": 404734177}, "404734179": {"name": "naturalearth", "license": "http://www.naturalearthdata.com/about/terms-of-use/", "url": "http://www.naturalearthdata.com/", "prefix": "ne", "key": "id", "fullname": "Natural Earth", "id": 404734179}, "404734181": {"name": "ourairports", "license": "http://ourairports.com/", "url": "http://ourairports.com/data/", "prefix": "oa", "key": "id", "fullname": "OurAirports", "id": 404734181}, "404734183": {"name": "quattroshapes", "license": "https://github.com/foursquare/quattroshapes/blob/master/LICENSE.md", "url": "http://www.quattroshapes.com/", "prefix": "qs", "key": "id", "fullname": "Quattroshapes", "id": 404734183}, "404734187": {"name": "whereonearth", "license": "http://developer.yahoo.com/geo/geoplanet/data/", "url": "http://developer.yahoo.com/geo/geoplanet/", "prefix": "woe", "key": "id", "fullname": "Yahoo! GeoPlanet (formerly Where On Earth)", "id": 404734187}, "404734189": {"name": "wikipedia", "license": "https://en.wikipedia.org/wiki/Wikipedia:Copyrights", "url": "http://www.wikipedia.org/", "prefix": "wk", "key": "page", "fullname": "Wikipedia", "id": 404734189}, "404734191": {"name": "zetashapes", "license": "http://www.zetashapes.com/license", "url": "http://www.zetashapes.com", "prefix": "zs", "key": "id", "fullname": "Zetashapes", "id": 404734191}, "404734193": {"name": "factual", "license": "", "url": "https://github.com/Factual/places", "prefix": "fct", "key": "id", "fullname": "Factual", "id": 404734193}, "404734195": {"name": "mapshaper", "license": "CC0", "url": "https://github.com/mbloch/mapshaper", "prefix": "ms", "key": "", "fullname": "Mapshaper", "id": 404734195, "description": ""}, "404734197": {"name": "mapzen", "license": "CC0", "url": "https://www.mapzen.com/", "prefix": "mz", "key": "", "fullname": "Mapzen", "id": 404734197, "description": ""}, "404734199": {"name": "simplegeo", "license": "https://creativecommons.org/publicdomain/zero/1.0/", "url": "", "prefix": "sg", "key": "id", "fullname": "SimpleGeo", "id": 404734199, "description": "SimpleGeo was a location aware services company that operated between 2009 and 2011. It is no longer an active company."}, "404734201": {"name": "yerbashapes", "license": "CC0", "url": "", "prefix": "ys", "key": "", "fullname": "Yerbashapes", "id": 404734201, "description": "Weighted means from Quattroshapes"}, "420577535": {"name": "wikidata", "license": "https://creativecommons.org/publicdomain/zero/1.0/", "url": "https://www.wikidata.org/", "prefix": "wd", "key": "id", "fullname": "Wikidata", "id": 420577535, "description": "Concordances against Wikidata; public domain structured data."}, "404734205": {"name": "burritojustice", "license": "CC0", "url": "http://burritojustice.com/la-lengua/", "prefix": "bj", "key": "id", "fullname": "Burrito Justice", "id": 404734205, "description": ""}, "404734207": {"name": "woedb", "license": "CC0", "url": "http://woe.spum.org/", "prefix": "woedb", "key": "id", "fullname": "WOE DB", "id": 404734207, "description": ""}}

__NAMES__ = {}
__PREFIXES__ = {}

for id, details in __SPEC__.items():
    name = details['name']
    prefix = details['prefix']

    __NAMES__[name] = id
    __PREFIXES__[prefix] = id

def is_valid_source(k):

    if __SPEC__.get(k, False):
        return True

    if __NAMES__.get(k, False):
        return True

    if __PREFIXES__.get(k, False):
        return True

    return False

def get_source_by_name(n):

    id = __NAMES__.get(n, None)

    if not id:
        return None

    return source(id)

def get_source_by_prefix(p):

    id = __PREFIXES__.get(p, None)

    if not id:
        return None

    return source(id)

def get_source_by_id(id):

    if not __SPEC__.get(id, None):
        return None

    return source(id)

class source:

    def __init__(self, id):

        if not __SPEC__.get(id, False):
            raise Exception, "Invalid source ID"

        self.details = __SPEC__[id]

    def __repr__(self):
        return self.stringify()

    def __str__(self):
        return self.stringify()
        
    def stringify(self):

        fullname = self.details['fullname']
        name = self.details['name']
        lookup = self.lookup_key()

        if not lookup:
            return "%s (%s)" % (fullname, name)
        
        return "%s (%s)" % (fullname, lookup)

    def lookup_key(self):
        prefix = self.details['prefix']
        key = self.details['key']

        if key == '':
            return None

        return "%s:%s" % (prefix, key)
